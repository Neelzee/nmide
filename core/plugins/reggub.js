(()=>{var de=Object.create;var Ct=Object.defineProperty;var he=Object.getOwnPropertyDescriptor;var me=Object.getOwnPropertyNames;var ge=Object.getPrototypeOf,ye=Object.prototype.hasOwnProperty;var Mr=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Re=(r,t,n,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of me(t))!ye.call(r,o)&&o!==n&&Ct(r,o,{get:()=>t[o],enumerable:!(e=he(t,o))||e.enumerable});return r};var Q=(r,t,n)=>(n=r!=null?de(ge(r)):{},Re(t||!r||!r.__esModule?Ct(n,"default",{value:r,enumerable:!0}):n,r));var Y=Mr(v=>{"use strict";var _e=v&&v.__spreadArray||function(r,t,n){if(n||arguments.length===2)for(var e=0,o=t.length,u;e<o;e++)(u||!(e in t))&&(u||(u=Array.prototype.slice.call(t,0,e)),u[e]=t[e]);return r.concat(u||Array.prototype.slice.call(t))};Object.defineProperty(v,"__esModule",{value:!0});v.dual=v.getEndomorphismMonoid=v.SK=v.hole=v.constVoid=v.constUndefined=v.constNull=v.constFalse=v.constTrue=v.unsafeCoerce=v.apply=v.getRing=v.getSemiring=v.getMonoid=v.getSemigroup=v.getBooleanAlgebra=void 0;v.identity=Yr;v.constant=lr;v.flip=Oe;v.flow=kt;v.tuple=Ue;v.increment=we;v.decrement=be;v.absurd=jt;v.tupled=Ne;v.untupled=Se;v.pipe=qe;v.not=Ve;var Ie=function(r){return function(){return{meet:function(t,n){return function(e){return r.meet(t(e),n(e))}},join:function(t,n){return function(e){return r.join(t(e),n(e))}},zero:function(){return r.zero},one:function(){return r.one},implies:function(t,n){return function(e){return r.implies(t(e),n(e))}},not:function(t){return function(n){return r.not(t(n))}}}}};v.getBooleanAlgebra=Ie;var Ae=function(r){return function(){return{concat:function(t,n){return function(e){return r.concat(t(e),n(e))}}}}};v.getSemigroup=Ae;var Te=function(r){var t=(0,v.getSemigroup)(r);return function(){return{concat:t().concat,empty:function(){return r.empty}}}};v.getMonoid=Te;var Me=function(r){return{add:function(t,n){return function(e){return r.add(t(e),n(e))}},zero:function(){return r.zero},mul:function(t,n){return function(e){return r.mul(t(e),n(e))}},one:function(){return r.one}}};v.getSemiring=Me;var Ee=function(r){var t=(0,v.getSemiring)(r);return{add:t.add,mul:t.mul,one:t.one,zero:t.zero,sub:function(n,e){return function(o){return r.sub(n(o),e(o))}}}};v.getRing=Ee;var We=function(r){return function(t){return t(r)}};v.apply=We;function Yr(r){return r}v.unsafeCoerce=Yr;function lr(r){return function(){return r}}v.constTrue=lr(!0);v.constFalse=lr(!1);v.constNull=lr(null);v.constUndefined=lr(void 0);v.constVoid=v.constUndefined;function Oe(r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.length>1?r(t[1],t[0]):function(e){return r(e)(t[0])}}}function kt(r,t,n,e,o,u,i,a,p){switch(arguments.length){case 1:return r;case 2:return function(){return t(r.apply(this,arguments))};case 3:return function(){return n(t(r.apply(this,arguments)))};case 4:return function(){return e(n(t(r.apply(this,arguments))))};case 5:return function(){return o(e(n(t(r.apply(this,arguments)))))};case 6:return function(){return u(o(e(n(t(r.apply(this,arguments))))))};case 7:return function(){return i(u(o(e(n(t(r.apply(this,arguments)))))))};case 8:return function(){return a(i(u(o(e(n(t(r.apply(this,arguments))))))))};case 9:return function(){return p(a(i(u(o(e(n(t(r.apply(this,arguments)))))))))}}}function Ue(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return r}function we(r){return r+1}function be(r){return r-1}function jt(r){throw new Error("Called `absurd` function which should be uncallable")}function Ne(r){return function(t){return r.apply(void 0,t)}}function Se(r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r(t)}}function qe(r,t,n,e,o,u,i,a,p){switch(arguments.length){case 1:return r;case 2:return t(r);case 3:return n(t(r));case 4:return e(n(t(r)));case 5:return o(e(n(t(r))));case 6:return u(o(e(n(t(r)))));case 7:return i(u(o(e(n(t(r))))));case 8:return a(i(u(o(e(n(t(r)))))));case 9:return p(a(i(u(o(e(n(t(r))))))));default:{for(var f=arguments[0],d=1;d<arguments.length;d++)f=arguments[d](f);return f}}}v.hole=jt;var Fe=function(r,t){return t};v.SK=Fe;function Ve(r){return function(t){return!r(t)}}var Le=function(){return{concat:function(r,t){return kt(r,t)},empty:Yr}};v.getEndomorphismMonoid=Le;var Ce=function(r,t){var n=typeof r=="number"?function(e){return e.length>=r}:r;return function(){var e=Array.from(arguments);return n(arguments)?t.apply(this,e):function(o){return t.apply(void 0,_e([o],e,!1))}}};v.dual=Ce});var Rt=Mr(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.eqDate=x.eqNumber=x.eqString=x.eqBoolean=x.eq=x.strictEqual=x.getStructEq=x.getTupleEq=x.Contravariant=x.getMonoid=x.getSemigroup=x.eqStrict=x.URI=x.contramap=x.tuple=x.struct=x.fromEquals=void 0;var au=Y(),iu=function(r){return{equals:function(t,n){return t===n||r(t,n)}}};x.fromEquals=iu;var pu=function(r){return(0,x.fromEquals)(function(t,n){for(var e in r)if(!r[e].equals(t[e],n[e]))return!1;return!0})};x.struct=pu;var cu=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return(0,x.fromEquals)(function(n,e){return r.every(function(o,u){return o.equals(n[u],e[u])})})};x.tuple=cu;var fu=function(r,t){return(0,au.pipe)(r,(0,x.contramap)(t))},vu=function(r){return function(t){return(0,x.fromEquals)(function(n,e){return t.equals(r(n),r(e))})}};x.contramap=vu;x.URI="Eq";x.eqStrict={equals:function(r,t){return r===t}};var lu={equals:function(){return!0}},xu=function(){return{concat:function(r,t){return(0,x.fromEquals)(function(n,e){return r.equals(n,e)&&t.equals(n,e)})}}};x.getSemigroup=xu;var su=function(){return{concat:(0,x.getSemigroup)().concat,empty:lu}};x.getMonoid=su;x.Contravariant={URI:x.URI,contramap:fu};x.getTupleEq=x.tuple;x.getStructEq=x.struct;x.strictEqual=x.eqStrict.equals;x.eq=x.Contravariant;x.eqBoolean=x.eqStrict;x.eqString=x.eqStrict;x.eqNumber=x.eqStrict;x.eqDate={equals:function(r,t){return r.valueOf()===t.valueOf()}}});var jn=Mr(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.ordDate=c.ordNumber=c.ordString=c.ordBoolean=c.ord=c.getDualOrd=c.getTupleOrd=c.between=c.clamp=c.max=c.min=c.geq=c.leq=c.gt=c.lt=c.equals=c.trivial=c.Contravariant=c.getMonoid=c.getSemigroup=c.URI=c.contramap=c.reverse=c.tuple=c.fromCompare=c.equalsDefault=void 0;var bu=Rt(),$r=Y(),Nu=function(r){return function(t,n){return t===n||r(t,n)===0}};c.equalsDefault=Nu;var Su=function(r){return{equals:(0,c.equalsDefault)(r),compare:function(t,n){return t===n?0:r(t,n)}}};c.fromCompare=Su;var qu=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return(0,c.fromCompare)(function(n,e){for(var o=0;o<r.length-1;o++){var u=r[o].compare(n[o],e[o]);if(u!==0)return u}return r[o].compare(n[o],e[o])})};c.tuple=qu;var Fu=function(r){return(0,c.fromCompare)(function(t,n){return r.compare(n,t)})};c.reverse=Fu;var Vu=function(r,t){return(0,$r.pipe)(r,(0,c.contramap)(t))},Lu=function(r){return function(t){return(0,c.fromCompare)(function(n,e){return t.compare(r(n),r(e))})}};c.contramap=Lu;c.URI="Ord";var Cu=function(){return{concat:function(r,t){return(0,c.fromCompare)(function(n,e){var o=r.compare(n,e);return o!==0?o:t.compare(n,e)})}}};c.getSemigroup=Cu;var ku=function(){return{concat:(0,c.getSemigroup)().concat,empty:(0,c.fromCompare)(function(){return 0})}};c.getMonoid=ku;c.Contravariant={URI:c.URI,contramap:Vu};c.trivial={equals:$r.constTrue,compare:(0,$r.constant)(0)};var ju=function(r){return function(t){return function(n){return n===t||r.compare(n,t)===0}}};c.equals=ju;var Bu=function(r){return function(t,n){return r.compare(t,n)===-1}};c.lt=Bu;var Pu=function(r){return function(t,n){return r.compare(t,n)===1}};c.gt=Pu;var Du=function(r){return function(t,n){return r.compare(t,n)!==1}};c.leq=Du;var Ku=function(r){return function(t,n){return r.compare(t,n)!==-1}};c.geq=Ku;var zu=function(r){return function(t,n){return t===n||r.compare(t,n)<1?t:n}};c.min=zu;var Hu=function(r){return function(t,n){return t===n||r.compare(t,n)>-1?t:n}};c.max=Hu;var Ju=function(r){var t=(0,c.min)(r),n=(0,c.max)(r);return function(e,o){return function(u){return n(t(u,o),e)}}};c.clamp=Ju;var $u=function(r){var t=(0,c.lt)(r),n=(0,c.gt)(r);return function(e,o){return function(u){return!(t(u,e)||n(u,o))}}};c.between=$u;c.getTupleOrd=c.tuple;c.getDualOrd=c.reverse;c.ord=c.Contravariant;function Zu(r,t){return r<t?-1:r>t?1:0}var At={equals:bu.eqStrict.equals,compare:Zu};c.ordBoolean=At;c.ordString=At;c.ordNumber=At;c.ordDate=(0,$r.pipe)(c.ordNumber,(0,c.contramap)(function(r){return r.valueOf()}))});var ve=Mr(l=>{"use strict";var fa=l&&l.__spreadArray||function(r,t,n){if(n||arguments.length===2)for(var e=0,o=t.length,u;e<o;e++)(u||!(e in t))&&(u||(u=Array.prototype.slice.call(t,0,e)),u[e]=t[e]);return r.concat(u||Array.prototype.slice.call(t))};Object.defineProperty(l,"__esModule",{value:!0});l.dual=l.getEndomorphismMonoid=l.SK=l.hole=l.constVoid=l.constUndefined=l.constNull=l.constFalse=l.constTrue=l.unsafeCoerce=l.apply=l.getRing=l.getSemiring=l.getMonoid=l.getSemigroup=l.getBooleanAlgebra=void 0;l.identity=Vt;l.constant=Ar;l.flip=ma;l.flow=ce;l.tuple=ga;l.increment=ya;l.decrement=Ra;l.absurd=fe;l.tupled=_a;l.untupled=Ia;l.pipe=Aa;l.not=Ma;var va=function(r){return function(){return{meet:function(t,n){return function(e){return r.meet(t(e),n(e))}},join:function(t,n){return function(e){return r.join(t(e),n(e))}},zero:function(){return r.zero},one:function(){return r.one},implies:function(t,n){return function(e){return r.implies(t(e),n(e))}},not:function(t){return function(n){return r.not(t(n))}}}}};l.getBooleanAlgebra=va;var la=function(r){return function(){return{concat:function(t,n){return function(e){return r.concat(t(e),n(e))}}}}};l.getSemigroup=la;var xa=function(r){var t=(0,l.getSemigroup)(r);return function(){return{concat:t().concat,empty:function(){return r.empty}}}};l.getMonoid=xa;var sa=function(r){return{add:function(t,n){return function(e){return r.add(t(e),n(e))}},zero:function(){return r.zero},mul:function(t,n){return function(e){return r.mul(t(e),n(e))}},one:function(){return r.one}}};l.getSemiring=sa;var da=function(r){var t=(0,l.getSemiring)(r);return{add:t.add,mul:t.mul,one:t.one,zero:t.zero,sub:function(n,e){return function(o){return r.sub(n(o),e(o))}}}};l.getRing=da;var ha=function(r){return function(t){return t(r)}};l.apply=ha;function Vt(r){return r}l.unsafeCoerce=Vt;function Ar(r){return function(){return r}}l.constTrue=Ar(!0);l.constFalse=Ar(!1);l.constNull=Ar(null);l.constUndefined=Ar(void 0);l.constVoid=l.constUndefined;function ma(r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.length>1?r(t[1],t[0]):function(e){return r(e)(t[0])}}}function ce(r,t,n,e,o,u,i,a,p){switch(arguments.length){case 1:return r;case 2:return function(){return t(r.apply(this,arguments))};case 3:return function(){return n(t(r.apply(this,arguments)))};case 4:return function(){return e(n(t(r.apply(this,arguments))))};case 5:return function(){return o(e(n(t(r.apply(this,arguments)))))};case 6:return function(){return u(o(e(n(t(r.apply(this,arguments))))))};case 7:return function(){return i(u(o(e(n(t(r.apply(this,arguments)))))))};case 8:return function(){return a(i(u(o(e(n(t(r.apply(this,arguments))))))))};case 9:return function(){return p(a(i(u(o(e(n(t(r.apply(this,arguments)))))))))}}}function ga(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return r}function ya(r){return r+1}function Ra(r){return r-1}function fe(r){throw new Error("Called `absurd` function which should be uncallable")}function _a(r){return function(t){return r.apply(void 0,t)}}function Ia(r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r(t)}}function Aa(r,t,n,e,o,u,i,a,p){switch(arguments.length){case 1:return r;case 2:return t(r);case 3:return n(t(r));case 4:return e(n(t(r)));case 5:return o(e(n(t(r))));case 6:return u(o(e(n(t(r)))));case 7:return i(u(o(e(n(t(r))))));case 8:return a(i(u(o(e(n(t(r)))))));case 9:return p(a(i(u(o(e(n(t(r))))))));default:{for(var f=arguments[0],d=1;d<arguments.length;d++)f=arguments[d](f);return f}}}l.hole=fe;var Ta=function(r,t){return t};l.SK=Ta;function Ma(r){return function(t){return!r(t)}}var Ea=function(){return{concat:function(r,t){return ce(r,t)},empty:Vt}};l.getEndomorphismMonoid=Ea;var Wa=function(r,t){var n=typeof r=="number"?function(e){return e.length>=r}:r;return function(){var e=Array.from(arguments);return n(arguments)?t.apply(this,e):function(o){return t.apply(void 0,fa([o],e,!1))}}};l.dual=Wa});var s=class r{_kind="Frag";_kids=[];_attrs=[];_text=null;kind(t){return this._kind=t,this}kids(t){return this._kids=t,this}attrs(t){return this._attrs=t,this}text(t){return this._text=t,this}build(){return{kind:this._kind,kids:this._kids.map(t=>t instanceof r?t.build():t),attrs:this._attrs,text:this._text}}};var ke=function(r,t,n){if(n||arguments.length===2)for(var e=0,o=t.length,u;e<o;e++)(u||!(e in t))&&(u||(u=Array.prototype.slice.call(t,0,e)),u[e]=t[e]);return r.concat(u||Array.prototype.slice.call(t))};function Er(r){return r}function Wr(r,t,n,e,o,u,i,a,p){switch(arguments.length){case 1:return r;case 2:return function(){return t(r.apply(this,arguments))};case 3:return function(){return n(t(r.apply(this,arguments)))};case 4:return function(){return e(n(t(r.apply(this,arguments))))};case 5:return function(){return o(e(n(t(r.apply(this,arguments)))))};case 6:return function(){return u(o(e(n(t(r.apply(this,arguments))))))};case 7:return function(){return i(u(o(e(n(t(r.apply(this,arguments)))))))};case 8:return function(){return a(i(u(o(e(n(t(r.apply(this,arguments))))))))};case 9:return function(){return p(a(i(u(o(e(n(t(r.apply(this,arguments)))))))))}}}function k(r,t,n,e,o,u,i,a,p){switch(arguments.length){case 1:return r;case 2:return t(r);case 3:return n(t(r));case 4:return e(n(t(r)));case 5:return o(e(n(t(r))));case 6:return u(o(e(n(t(r)))));case 7:return i(u(o(e(n(t(r))))));case 8:return a(i(u(o(e(n(t(r)))))));case 9:return p(a(i(u(o(e(n(t(r))))))));default:{for(var f=arguments[0],d=1;d<arguments.length;d++)f=arguments[d](f);return f}}}var N=function(r,t){var n=typeof r=="number"?function(e){return e.length>=r}:r;return function(){var e=Array.from(arguments);return n(arguments)?t.apply(this,e):function(o){return t.apply(void 0,ke([o],e,!1))}}};var je=function(r,t,n){if(n||arguments.length===2)for(var e=0,o=t.length,u;e<o;e++)(u||!(e in t))&&(u||(u=Array.prototype.slice.call(t,0,e)),u[e]=t[e]);return r.concat(u||Array.prototype.slice.call(t))};var Or=function(r){return r._tag==="Some"},z={_tag:"None"},H=function(r){return{_tag:"Some",value:r}},Ur=function(r){return r._tag==="Left"};var Bt=function(r){return{_tag:"Left",left:r}},Pt=function(r){return{_tag:"Right",right:r}};var wr=function(r){return r[0]};var rt=function(r){return je([r[0]],r.slice(1),!0)};function tr(r){return function(t,n){return r.chain(t,function(e){return r.map(n(e),function(){return e})})}}function Kt(r){return function(t){return Wr(t,r.fromEither)}}function zt(r,t){var n=Kt(r),e=tr(t);return function(o,u){return e(o,n(u))}}function xr(r){return function(t,n){return r.map(t,function(){return n})}}function br(r){var t=xr(r);return function(n){return t(n,void 0)}}var Ht=function(r){return{equals:function(t,n){return t===n||r(t,n)}}};var tt={equals:function(r,t){return r===t}};var Da=tt.equals;var Be=function(r){return function(t,n){return t===n||r(t,n)===0}},Jt=function(r){return{equals:Be(r),compare:function(t,n){return t===n?0:r(t,n)}}};function Pe(r,t){return r<t?-1:r>t?1:0}var Ha={equals:tt.equals,compare:Pe};var Ke=wr;var Gt=Ke;var nt=function(r,t,n){if(n||arguments.length===2)for(var e=0,o=t.length,u;e<o;e++)(u||!(e in t))&&(u||(u=Array.prototype.slice.call(t,0,e)),u[e]=t[e]);return r.concat(u||Array.prototype.slice.call(t))},Xt=function(r){return r.length>0};var Qt=function(r){return function(t){return nt([r],t,!0)}},et=Qt,Yt=function(r){return function(t){return nt(nt([],t,!0),[r],!1)}},rn=Yt;var He=rt;var Je=He;var tn=function(r){return function(t){var n=Math.max(1,r);return n>=t.length?[Je(t),[]]:[k(t.slice(1,n),et(Nr(t))),t.slice(n)]}};var Nr=Gt,ot=function(r){return r.slice(1)};var dr={equals:function(r,t){return r===t}},ut={equals:dr.equals,compare:function(r,t){return r<t?-1:r>t?1:0}},fi={equals:dr.equals,compare:ut.compare,top:1/0,bottom:-1/0};var $e={concat:function(r,t){return r-t}},en={concat:function(r,t){return r+t}},on={concat:function(r,t){return r*t}},vi={concat:en.concat,empty:0},li={concat:on.concat,empty:1},xi={add:en.concat,zero:0,mul:on.concat,one:1,sub:$e.concat,degree:function(r){return 1},div:function(r,t){return r/t},mod:function(r,t){return r%t}};function un(r){return function(t){for(var n=0;n<t.length;n++)if(r(t[n]))return H(t[n]);return z}}var an=function(r){return function(t){return function(n){return n.reduce(function(e,o,u){return r.concat(e,t(u,o))},r.empty)}}};var pn=function(r){var t=an(r);return function(n){return t(function(e,o){return n(o)})}};var cn=function(r){return Ht(function(t,n){return t.length===n.length&&t.every(function(e,o){return r.equals(e,n[o])})})},fn=function(r){return Jt(function(t,n){for(var e=t.length,o=n.length,u=Math.min(e,o),i=0;i<u;i++){var a=r.compare(t[i],n[i]);if(a!==0)return a}return ut.compare(e,o)})};var at=function(r){return r.length===0},it=Xt,pt=et;var vn=rn;var ln=function(r){return r.length};var Qe=function(r,t){for(var n=r.length,e=0;e<n&&t(r[e]);e++);return e};function xn(r){return function(t){var n=ro(Qe(t,r))(t),e=n[0],o=n[1];return{init:e,rest:o}}}function Sr(r){return un(r)}var hr=function(r){return r.slice()};var ct=function(r){return function(t){return t.length<=1?hr(t):t.slice().sort(r.compare)}},Ye=function(r,t,n){for(var e=[],o=Math.min(r.length,t.length),u=0;u<o;u++)e[u]=n(r[u],t[u]);return e};function ft(r,t){return t===void 0?function(n){return ft(n,r)}:Ye(r,t,function(n,e){return[n,e]})}var ro=function(r){return function(t){return r>=1&&it(t)?tn(r)(t):at(t)?[hr(t),[]]:[[],hr(t)]}};var to=function(r){return function(t){return at(t)?hr(r):at(r)?hr(t):t.concat(r)}},vt=to;var qr=function(r){return function(t){return t.map(function(n){return r(n)})}};var no=function(r){return function(t){for(var n=[],e=0;e<t.length;e++){var o=r(e,t[e]);Or(o)&&n.push(o.value)}return n}},Fr=function(r){return no(function(t,n){return r(n)})};var lt=pn;var xt=cn,sn=fn;var nr={equals:function(r,t){return r===t}},eo={concat:function(r,t){return r+t}},oo="",rp={concat:eo.concat,empty:oo},dn={equals:nr.equals,compare:function(r,t){return r<t?-1:r>t?1:0}};var hn=Bt,Vr=Pt,fo=N(2,function(r,t){return M(r)?r:t(r.right)}),mn=function(r,t){return k(r,lo(t))},vo=function(r,t){return k(r,so(t))};var dt="Either";var lo=function(r){return function(t){return M(t)?t:Vr(r(t.right))}},gn={URI:dt,map:mn},cp=N(2,xr(gn)),fp=br(gn);var xo=function(r){return function(t){return M(t)?t:M(r)?r:Vr(t.right(r.right))}},so=xo;var ho={URI:dt,map:mn,ap:vo,chain:fo};var mo={URI:dt,fromEither:Er};var M=Ur;var vp=N(2,tr(ho));var lp={fromEither:mo.fromEither};var m=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(e[u]=o[u])},r(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");r(t,n);function e(){this.constructor=t}t.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}}(),Lr=function(){return Lr=Object.assign||function(r){for(var t,n=1,e=arguments.length;n<e;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Lr.apply(this,arguments)};var gr=hn,E=function(r,t,n){return gr([{value:r,context:t,message:n}])},I=Vr,g=function(){function r(t,n,e,o){this.name=t,this.is=n,this.validate=e,this.encode=o,this.decode=this.decode.bind(this)}return r.prototype.pipe=function(t,n){var e=this;return n===void 0&&(n="pipe(".concat(this.name,", ").concat(t.name,")")),new r(n,t.is,function(o,u){var i=e.validate(o,u);return M(i)?i:t.validate(i.right,u)},this.encode===y&&t.encode===y?y:function(o){return e.encode(t.encode(o))})},r.prototype.asDecoder=function(){return this},r.prototype.asEncoder=function(){return this},r.prototype.decode=function(t){return this.validate(t,[{key:"",type:this,actual:t}])},r}();var y=function(r){return r};function go(r){return r.displayName||r.name||"<function".concat(r.length,">")}function mr(r,t,n,e){for(var o=r.length,u=Array(o+1),i=0;i<o;i++)u[i]=r[i];return u[o]={key:t,type:n,actual:e},u}function Pr(r,t){for(var n=t.length,e=0;e<n;e++)r.push(t[e])}var Cr=Object.prototype.hasOwnProperty;function yo(r){return Object.keys(r).map(function(t){return"".concat(t,": ").concat(r[t].name)}).join(", ")}function kr(r){for(var t=0;t<r.length;t++)if(r[t].encode!==y)return!1;return!0}function Ro(r){return"{ ".concat(yo(r)," }")}function _o(r){return"("+r.map(function(t){return t.name}).join(" | ")+")"}function Io(r){return r.length>0}var O={};function Rn(r,t){for(var n=[],e=0,o=r;e<o.length;e++){var u=o[e];t.indexOf(u)!==-1&&n.push(u)}return n}function Ao(r,t){if(r===O)return t;if(t===O)return r;var n=Object.assign({},r);for(var e in t)if(Cr.call(r,e)){var o=Rn(r[e],t[e]);if(Io(o))n[e]=o;else{n=O;break}}else n[e]=t[e];return n}function To(r,t){if(r===O||t===O)return O;var n=O;for(var e in r)if(Cr.call(t,e)){var o=Rn(r[e],t[e]);o.length===0&&(n===O&&(n={}),n[e]=r[e].concat(t[e]))}return n}function Mo(r){return r._tag==="LiteralType"}function Eo(r){return r._tag==="InterfaceType"}function Wo(r){return r._tag==="StrictType"}function Oo(r){return r._tag==="ExactType"}function Uo(r){return r._tag==="RefinementType"}function wo(r){return r._tag==="IntersectionType"}function bo(r){return r._tag==="UnionType"}function No(r){return r._tag==="RecursiveType"}var ht=[];function J(r){if(ht.indexOf(r)!==-1)return O;if(Eo(r)||Wo(r)){var t=O;for(var n in r.props){var e=r.props[n];Mo(e)&&(t===O&&(t={}),t[n]=[e.value])}return t}else{if(Oo(r)||Uo(r))return J(r.type);if(wo(r))return r.types.reduce(function(u,i){return Ao(u,J(i))},O);if(bo(r))return r.types.slice(1).reduce(function(u,i){return To(u,J(i))},J(r.types[0]));if(No(r)){ht.push(r);var o=J(r.type);return ht.pop(),o}}return O}function So(r){var t=J(r[0]),n=Object.keys(t),e=r.length,o=function(f){for(var d=t[f].slice(),_=[t[f]],R=1;R<e;R++){var L=r[R],Tr=J(L),C=Tr[f];if(C===void 0)return"continue-keys";if(C.some(function(vr){return d.indexOf(vr)!==-1}))return"continue-keys";d.push.apply(d,C),_.push(C)}return{value:[f,_]}};r:for(var u=0,i=n;u<i.length;u++){var a=i[u],p=o(a);if(typeof p=="object")return p.value;switch(p){case"continue-keys":continue r}}}var qo=function(r){m(t,r);function t(){var n=r.call(this,"null",function(e){return e===null},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="NullType",n}return t}(g);var _n=new qo,Fo=function(r){m(t,r);function t(){var n=r.call(this,"undefined",function(e){return e===void 0},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="UndefinedType",n}return t}(g);var yn=new Fo,Vo=function(r){m(t,r);function t(){var n=r.call(this,"void",yn.is,yn.validate,y)||this;return n._tag="VoidType",n}return t}(g);var dp=new Vo,Lo=function(r){m(t,r);function t(){var n=r.call(this,"unknown",function(e){return!0},I,y)||this;return n._tag="UnknownType",n}return t}(g);var hp=new Lo,Co=function(r){m(t,r);function t(){var n=r.call(this,"string",function(e){return typeof e=="string"},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="StringType",n}return t}(g);var U=new Co,ko=function(r){m(t,r);function t(){var n=r.call(this,"number",function(e){return typeof e=="number"},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="NumberType",n}return t}(g);var yr=new ko,jo=function(r){m(t,r);function t(){var n=r.call(this,"bigint",function(e){return typeof e=="bigint"},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="BigIntType",n}return t}(g);var mp=new jo,Bo=function(r){m(t,r);function t(){var n=r.call(this,"boolean",function(e){return typeof e=="boolean"},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="BooleanType",n}return t}(g);var mt=new Bo,Po=function(r){m(t,r);function t(){var n=r.call(this,"UnknownArray",Array.isArray,function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="AnyArrayType",n}return t}(g);var jr=new Po,Do=function(r){m(t,r);function t(){var n=r.call(this,"UnknownRecord",function(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="AnyDictionaryType",n}return t}(g);var Br=new Do;var Ko=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.value=i,a._tag="LiteralType",a}return t}(g);function h(r,t){t===void 0&&(t=JSON.stringify(r));var n=function(e){return e===r};return new Ko(t,n,function(e,o){return n(e)?I(r):E(e,o)},y,r)}var gp=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.keys=i,a._tag="KeyofType",a}return t}(g);var zo=function(r){m(t,r);function t(n,e,o,u,i,a){var p=r.call(this,n,e,o,u)||this;return p.type=i,p.predicate=a,p._tag="RefinementType",p}return t}(g);function Ho(r,t,n){return Tn(r,t,n)}var yp=Ho(yr,function(r){return Number.isInteger(r)},"Int"),In=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.runDefinition=i,a._tag="RecursiveType",a}return t}(g);Object.defineProperty(In.prototype,"type",{get:function(){return this.runDefinition()},enumerable:!0,configurable:!0});function gt(r,t){var n,e=function(){return n||(n=t(o),n.name=r),n},o=new In(r,function(u){return e().is(u)},function(u,i){return e().validate(u,i)},function(u){return e().encode(u)},e);return o}var Jo=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.type=i,a._tag="ArrayType",a}return t}(g);function F(r,t){return t===void 0&&(t="Array<".concat(r.name,">")),new Jo(t,function(n){return jr.is(n)&&n.every(r.is)},function(n,e){var o=jr.validate(n,e);if(M(o))return o;for(var u=o.right,i=u.length,a=u,p=[],f=0;f<i;f++){var d=u[f],_=r.validate(d,mr(e,String(f),r,d));if(M(_))Pr(p,_.left);else{var R=_.right;R!==d&&(a===u&&(a=u.slice()),a[f]=R)}}return p.length>0?gr(p):I(a)},r.encode===y?y:function(n){return n.map(r.encode)},r)}var $o=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.props=i,a._tag="InterfaceType",a}return t}(g);function A(r,t){t===void 0&&(t=Ro(r));var n=Object.keys(r),e=n.map(function(u){return r[u]}),o=n.length;return new $o(t,function(u){if(Br.is(u)){for(var i=0;i<o;i++){var a=n[i],p=u[a];if(p===void 0&&!Cr.call(u,a)||!e[i].is(p))return!1}return!0}return!1},function(u,i){var a=Br.validate(u,i);if(M(a))return a;for(var p=a.right,f=p,d=[],_=0;_<o;_++){var R=n[_],L=f[R],Tr=e[_],C=Tr.validate(L,mr(i,R,Tr,L));if(M(C))Pr(d,C.left);else{var vr=C.right;(vr!==L||vr===void 0&&!Cr.call(f,R))&&(f===p&&(f=Lr({},p)),f[R]=vr)}}return d.length>0?gr(d):I(f)},kr(e)?y:function(u){for(var i=Lr({},u),a=0;a<o;a++){var p=n[a],f=e[a].encode;f!==y&&(i[p]=f(u[p]))}return i},r)}var Rp=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.props=i,a._tag="PartialType",a}return t}(g);var _p=function(r){m(t,r);function t(n,e,o,u,i,a){var p=r.call(this,n,e,o,u)||this;return p.domain=i,p.codomain=a,p._tag="DictionaryType",p}return t}(g);var An=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.types=i,a._tag="UnionType",a}return t}(g);function Rr(r,t){t===void 0&&(t=_o(r));var n=So(r);if(n!==void 0&&r.length>0){var e=n[0],o=n[1],u=o.length,i=function(a){for(var p=0;p<u;p++)if(o[p].indexOf(a)!==-1)return p};return new Yo(t,function(a){if(Br.is(a)){var p=i(a[e]);return p!==void 0?r[p].is(a):!1}return!1},function(a,p){var f=Br.validate(a,p);if(M(f))return f;var d=f.right,_=i(d[e]);if(_===void 0)return E(a,p);var R=r[_];return R.validate(d,mr(p,String(_),R,d))},kr(r)?y:function(a){var p=i(a[e]);if(p===void 0)throw new Error("no codec found to encode value in union codec ".concat(t));return r[p].encode(a)},r,e)}else return new An(t,function(a){return r.some(function(p){return p.is(a)})},function(a,p){for(var f=[],d=0;d<r.length;d++){var _=r[d],R=_.validate(a,mr(p,String(d),_,a));if(M(R))Pr(f,R.left);else return I(R.right)}return gr(f)},kr(r)?y:function(a){for(var p=0,f=r;p<f.length;p++){var d=f[p];if(d.is(a))return d.encode(a)}throw new Error("no codec found to encode value in union type ".concat(t))},r)}var Ip=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.types=i,a._tag="IntersectionType",a}return t}(g);var Zo=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.types=i,a._tag="TupleType",a}return t}(g);function er(r,t){t===void 0&&(t="[".concat(r.map(function(e){return e.name}).join(", "),"]"));var n=r.length;return new Zo(t,function(e){return jr.is(e)&&e.length===n&&r.every(function(o,u){return o.is(e[u])})},function(e,o){var u=jr.validate(e,o);if(M(u))return u;for(var i=u.right,a=i.length>n?i.slice(0,n):i,p=[],f=0;f<n;f++){var d=i[f],_=r[f],R=_.validate(d,mr(o,String(f),_,d));if(M(R))Pr(p,R.left);else{var L=R.right;L!==d&&(a===i&&(a=i.slice()),a[f]=L)}}return p.length>0?gr(p):I(a)},kr(r)?y:function(e){return r.map(function(o,u){return o.encode(e[u])})},r)}var Ap=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.type=i,a._tag="ReadonlyType",a}return t}(g);var Tp=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.type=i,a._tag="ReadonlyArrayType",a}return t}(g);var Mp=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.type=i,a._tag="ExactType",a}return t}(g);var Go=function(r){m(t,r);function t(){var n=r.call(this,"Function",function(e){return typeof e=="function"},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="FunctionType",n}return t}(g);var Ep=new Go,Xo=function(r){m(t,r);function t(){var n=r.call(this,"never",function(e){return!1},function(e,o){return E(e,o)},function(){throw new Error("cannot encode never")})||this;return n._tag="NeverType",n}return t}(g);var Wp=new Xo,Qo=function(r){m(t,r);function t(){var n=r.call(this,"any",function(e){return!0},I,y)||this;return n._tag="AnyType",n}return t}(g);var Op=new Qo;function Tn(r,t,n){return n===void 0&&(n="(".concat(r.name," | ").concat(go(t),")")),new zo(n,function(e){return r.is(e)&&t(e)},function(e,o){var u=r.validate(e,o);if(M(u))return u;var i=u.right;return t(i)?I(i):E(i,o)},r.encode,r,t)}var Up=Tn(yr,Number.isInteger,"Integer"),Yo=function(r){m(t,r);function t(n,e,o,u,i,a){var p=r.call(this,n,e,o,u,i)||this;return p.tag=a,p}return t}(An);var ru=function(r){m(t,r);function t(){var n=r.call(this,"object",function(e){return e!==null&&typeof e=="object"},function(e,o){return n.is(e)?I(e):E(e,o)},y)||this;return n._tag="ObjectType",n}return t}(g);var wp=new ru;var bp=function(r){m(t,r);function t(n,e,o,u,i){var a=r.call(this,n,e,o,u)||this;return a.props=i,a._tag="StrictType",a}return t}(g);var Dr=gt("DValue",()=>Rr([A({Int:yr}),A({Float:yr}),A({Bool:mt}),A({Str:U}),A({List:F(Dr)}),A({Obj:F(er([U,Dr]))})])),Mn=A({Msg:er([U,Dr])}),nu=Rr([A({Id:U}),A({Class:U}),A({Style:U}),A({OnClick:Mn}),A({OnInput:Mn}),A({EmitInput:U}),A({Src:U}),A({Type:U}),A({Checked:mt})]),eu=Rr([h("Div"),h("P"),h("H1"),h("H2"),h("H3"),h("H4"),h("H5"),h("H6"),h("Span"),h("Section"),h("Article"),h("Aside"),h("Audio"),h("B"),h("Br"),h("Button"),h("Code"),h("Em"),h("Fieldset"),h("Form"),h("Img"),h("Input"),h("Label"),h("Link"),h("Li"),h("Menu"),h("Nav"),h("Ol"),h("Option"),h("Select"),h("Style"),h("Svg"),h("Table"),h("Td"),h("Th"),h("Ul"),h("Video"),h("Frag"),h("Text"),h("Script"),h("Tr"),h("Tbody")]),En=gt("DHtml",()=>A({kind:eu,kids:F(En),text:Rr([U,_n]),attrs:F(nu)})),yt=F(er([U,Dr])),Np=F(yt),Sp=F(er([U,yt]));var ou=F(En),qp=er([ou,yt]);var X=Q(Rt());var Et=Q(Y());function Wn(r){return r[0]}function On(r){return r[1]}var or=Wn,Kr=On;var _t={equals:function(r,t){return r===t}};var hu={concat:function(r,t){return r&&t}},mu={concat:function(r,t){return r||t}},wn={concat:hu.concat,empty:!0},bn={concat:mu.concat,empty:!1},jp={equals:_t.equals,compare:function(r,t){return r<t?-1:r>t?1:0}};var zr=Q(Y());var T=z,W=H;var gu=function(r){return r._tag==="Left"?T:W(r.right)},Nn=function(r,t){return k(r,j(t))},yu=function(r,t){return k(r,Ru(t))};var It="Option";var j=function(r){return function(t){return $(t)?T:W(r(t.value))}},Sn={URI:It,map:Nn},$p=N(2,xr(Sn)),Zp=br(Sn);var Ru=function(r){return function(t){return $(t)||$(r)?T:W(t.value(r.value))}};var _u=N(2,function(r,t){return $(r)?T:t(r.value)}),qn={URI:It,map:Nn,ap:yu,chain:_u};var Gp=N(2,function(r,t){return $(r)?t():r});var Iu=gu,Au={URI:It,fromEither:Iu};var $=function(r){return r._tag==="None"},Tu=function(r,t){return function(n){return $(n)?r():t(n.value)}};var _r=Tu;var Mu=function(r){return function(t){return $(t)?r():t.value}},Fn=Mu;var Xp=N(2,tr(qn)),Qp=N(2,zt(Au,qn));var ur=r=>"Int"in r,ar=r=>"Float"in r,Z=r=>"Str"in r,ir=r=>"Bool"in r,B=r=>"List"in r,q=r=>"Obj"in r;var Eu=r=>({Int:r}),Wu=r=>({Float:r}),V=r=>({Str:r}),S=r=>({Bool:r});var Jr=r=>({Obj:(0,zr.pipe)(r,Fr(([t,n])=>j(e=>[t,e])(Hr(n))))}),Ln=r=>typeof r=="number"?r%1!==0:!1,Ou=r=>typeof r=="number"&&!Ln(r),Uu=r=>typeof r=="boolean",Cn=r=>typeof r=="string",kn=r=>!Array.isArray(r)||r.length===0||!Array.isArray(r[0])&&r[0].length===2?!1:Cn(r[0][0]),wu=r=>Array.isArray(r)&&!kn(r),Hr=r=>Ln(r)?W(Wu(r)):Ou(r)?W(Eu(r)):Uu(r)?W(S(r)):Cn(r)?W(V(r)):wu(r)?(0,zr.pipe)(r,Fr(Hr),t=>t.length!==r.length?T:W({List:t})):kn(r)?(0,zr.pipe)(r,Fr(([t,n])=>j(e=>[t,e])(Hr(n))),t=>t.length!==r.length?T:W({Obj:t})):T;var G=Q(Y());var Bn=Q(jn());var P=r=>t=>(0,G.pipe)(t,Sr(([n,e])=>n===r),j(Kr),_r(()=>T,n=>Tt(n)?W(n):T)),D=r=>t=>(0,G.pipe)(t.Obj,Sr(([n,e])=>n===r),j(Kr),_r(()=>T,n=>Tt(n)?W(n):T)),Gr=r=>t=>n=>(0,G.pipe)(n.Obj,Sr(([e,o])=>e===r),j(Kr),_r(()=>T,e=>Tt(e)?W(e):T),Fn(()=>t)),Pn=(r,t)=>n=>(0,G.pipe)(D(r)(n),e=>e,_r(()=>({Obj:vn([r,t])(n.Obj)}),e=>(0,G.pipe)(n.Obj,qr(([o,u])=>o==r?[o,t]:[o,u]),o=>({Obj:o})))),Zr=r=>B(r)?qr(Zr)(r.List):q(r)?qr(([t,n])=>[t,Zr(n)])(r.Obj):ur(r)?r.Int:ar(r)?r.Float:ir(r)?r.Bool:r.Str;var Tt=r=>ur(r)||ar(r)||ir(r)||Z(r)||B(r)?!0:q(r);var Xr=r=>t=>it(t)?(0,G.pipe)(Nr(t),n=>{let e=xn(a=>r.equals(n,a))(ot(t)),o=e.init,u=e.rest;return pt(pt(n)(o))(Xr(r)(u))}):[];var Mt=(0,Bn.fromCompare)((r,t)=>dn.compare(or(r),or(t))),xc=sn(Mt);var Dn=()=>new s().build();var Kn=(0,X.fromEquals)(([r,t],[n,e])=>nr.equals(r,n)),Wt=(0,X.fromEquals)(([r,t],[n,e])=>nr.equals(r,n)?Hn.equals(t,e):!1),Ic=(0,X.fromEquals)((r,t)=>(0,Et.pipe)(ft(r)(t),lt(wn)(([n,e])=>Wt.equals(n,e)))),zn=(0,X.fromEquals)((r,t)=>(0,Et.pipe)(vt(r)(t),n=>n,ct(Mt),Xr(Kn),lt(bn)(n=>ln(n)!=1))),Hn=(0,X.fromEquals)((r,t)=>ur(r)&&ur(t)?dr.equals(r.Int,t.Int):ar(r)&&ar(t)?dr.equals(r.Float,t.Float):Z(r)&&Z(t)?nr.equals(r.Str,t.Str):ir(r)&&ir(t)?_t.equals(r.Bool,t.Bool):B(r)&&B(t)?xt(Hn).equals(r.List,t.List):q(r)&&q(t)?xt(Wt).equals(Array.from(r.Obj.values()),Array.from(t.Obj.values())):!1),Ac=(0,X.fromEquals)((r,t)=>nr.equals(or(r),or(t)));var Gu=function(r,t,n){if(n||arguments.length===2)for(var e=0,o=t.length,u;e<o;e++)(u||!(e in t))&&(u||(u=Array.prototype.slice.call(t,0,e)),u[e]=t[e]);return r.concat(u||Array.prototype.slice.call(t))};function Ot(r,t,n,e,o,u,i,a,p){switch(arguments.length){case 1:return r;case 2:return function(){return t(r.apply(this,arguments))};case 3:return function(){return n(t(r.apply(this,arguments)))};case 4:return function(){return e(n(t(r.apply(this,arguments))))};case 5:return function(){return o(e(n(t(r.apply(this,arguments)))))};case 6:return function(){return u(o(e(n(t(r.apply(this,arguments))))))};case 7:return function(){return i(u(o(e(n(t(r.apply(this,arguments)))))))};case 8:return function(){return a(i(u(o(e(n(t(r.apply(this,arguments))))))))};case 9:return function(){return p(a(i(u(o(e(n(t(r.apply(this,arguments)))))))))}}}function Ut(r,t,n,e,o,u,i,a,p){switch(arguments.length){case 1:return r;case 2:return t(r);case 3:return n(t(r));case 4:return e(n(t(r)));case 5:return o(e(n(t(r))));case 6:return u(o(e(n(t(r)))));case 7:return i(u(o(e(n(t(r))))));case 8:return a(i(u(o(e(n(t(r)))))));case 9:return p(a(i(u(o(e(n(t(r))))))));default:{for(var f=arguments[0],d=1;d<arguments.length;d++)f=arguments[d](f);return f}}}var pr=function(r,t){var n=typeof r=="number"?function(e){return e.length>=r}:r;return function(){var e=Array.from(arguments);return n(arguments)?t.apply(this,e):function(o){return t.apply(void 0,Gu([o],e,!1))}}};var Jn={_tag:"None"},$n=function(r){return{_tag:"Some",value:r}};function wt(r){return function(t,n){return r.map(t,function(){return n})}}function Zn(r){var t=wt(r);return function(n){return t(n,void 0)}}function Qr(r){return function(t,n){return r.chain(t,function(e){return r.map(n(e),function(){return e})})}}function Gn(r){return function(t){return Ot(t,r.fromEither)}}function Xn(r,t){var n=Gn(r),e=Qr(t);return function(o,u){return e(o,n(u))}}var Ir=Jn,bt=$n;var Yu=function(r){return r._tag==="Left"?Ir:bt(r.right)},Qn=function(r,t){return Ut(r,K(t))},ra=function(r,t){return Ut(r,ta(t))};var Nt="Option";var K=function(r){return function(t){return cr(t)?Ir:bt(r(t.value))}},Yn={URI:Nt,map:Qn},lf=pr(2,wt(Yn)),xf=Zn(Yn);var ta=function(r){return function(t){return cr(t)||cr(r)?Ir:bt(t.value(r.value))}};var na=pr(2,function(r,t){return cr(r)?Ir:t(r.value)}),re={URI:Nt,map:Qn,ap:ra,chain:na};var sf=pr(2,function(r,t){return cr(r)?t():r});var ea=Yu,oa={URI:Nt,fromEither:ea};var cr=function(r){return r._tag==="None"};var ua=function(r){return function(t){return cr(t)?r():t.value}},w=ua;var df=pr(2,Qr(re)),hf=pr(2,Xn(oa,re));var qt=r=>{window.plugins.forEach((t,n)=>{if(n==="reggub")return;let e=w(()=>Jr([["toggle-init",!1],["toggle-view",!1],["toggle-update",!1]]))(P(`${n}-state`)(r)),o=Gr("toggle-init")(S(!1))(e).Bool;t.init=o?()=>[]:t.init;let u=Gr("toggle-view")(S(!1))(e).Bool;t.view=u?a=>Dn():t.view;let i=Gr("toggle-update")(S(!1))(e).Bool;t.update=i?(a,p)=>[]:t.update})},te=()=>(qt([]),[]);var ne=(r,t)=>{let n=[];if(r.Msg[0]==="reggub-tab-btn"&&Z(r.Msg[1])&&n.push(["reggub-tab-btn",r.Msg[1]]),r.Msg[0]==="toggle-init"||r.Msg[0]==="toggle-update"||r.Msg[0]==="toggle-view"){let e=r.Msg[1];if(!q(e))return[];let o=w(()=>V(""))(D("plugin")(e)).Str,u=w(()=>S(!1))(D("checked")(e)),i=`${o}-state`,a=w(()=>Jr([["toggle-init",!1],["toggle-view",!1],["toggle-update",!1]]))(P(i)(t));u.Bool=!u.Bool;let p=Pn(r.Msg[0],u)(a);n.push([i,p])}return n};var aa=function(r,t,n){if(n||arguments.length===2)for(var e=0,o=t.length,u;e<o;e++)(u||!(e in t))&&(u||(u=Array.prototype.slice.call(t,0,e)),u[e]=t[e]);return r.concat(u||Array.prototype.slice.call(t))};var ee=function(r){return function(t){return aa([r],t,!0)}},oe=ee;var ue=function(r){return r.length===0};var ie=oe;var ae=function(r){return r.slice()};var pa=function(r){return function(t){return ue(t)?ae(r):ue(r)?ae(t):t.concat(r)}},Ft=pa;var fr=function(r){return function(t){return t.map(function(n){return r(n)})}};var pe=function(r){return function(t){return t.filter(r)}};var b=Q(ve());function le(r){return r[0]}var xe=le;var se=r=>(qt(r),new s().kids([new s().kind("Div").attrs([{Class:"tab"}]).kids([new s().kind("Button").text("Plugin").attrs([{OnClick:{Msg:["reggub-tab-btn",V("Plugin")]}},{Class:"tablinks"}]),new s().kind("Button").text("State").attrs([{OnClick:{Msg:["reggub-tab-btn",V("State")]}},{Class:"tablinks"}])]),new s().kids([Na(r),Ua(r)])]).build()),Ua=r=>new s().kind("Div").attrs([{Class:"tabstate tabcontent"},{Id:"State"}]).kids(wa(r)).build(),wa=r=>(0,b.pipe)(r,fr(([t,n])=>new s().kind("Table").attrs([{Class:"statefield"}]).kids([new s().kind("Tbody").kids([new s().kind("Tr").kids([new s().kind("Th").text("Field"),new s().kind("Th").text("Value")]),new s().kind("Tr").kids([new s().kind("Td").text(t),new s().kind("Td").kids([Lt(n)])])])]).build())),Lt=r=>q(r)?new s().kind("Table").kids((0,b.pipe)([new s().kind("Tr").kids([new s().kind("Th").text("Object-Field"),new s().kind("Th").text("Object-Value")])],Ft((0,b.pipe)(r.Obj,fr(([t,n])=>new s().kind("Tr").kids([new s().kind("Td").text(t),new s().kind("Td").kids([Lt(n)])])))))).build():B(r)?new s().kind("Table").kids((0,b.pipe)([new s().kind("Tr").kids([new s().kind("Th").text("Value")])],Ft((0,b.pipe)(r.List,fr(t=>new s().kind("Tr").kids([new s().kind("Td").kids([Lt(t)])])))))).build():new s().text(`${Zr(r)}`).build(),ba=()=>Array.from(window.plugins.entries()),Na=r=>new s().kind("Div").attrs([{Class:"tabplugin tabcontent"},{Id:"Plugin"}]).kids((0,b.pipe)(ba(),fr(xe),pe(t=>t!=="reggub"),fr(t=>qa(Sa(r,t))(t)),ie(new s().kind("P").text("Plugins").build()))).build(),Sa=(r,t)=>[(0,b.pipe)(r,P(`${t}-state`),K(n=>(0,b.pipe)(n,D("toggle-init"),K(e=>e.Bool),w(()=>!1))),w(()=>!1)),(0,b.pipe)(r,P(`${t}-state`),K(n=>(0,b.pipe)(n,D("toggle-update"),K(e=>e.Bool),w(()=>!1))),w(()=>!1)),(0,b.pipe)(r,P(`${t}-state`),K(n=>(0,b.pipe)(n,D("toggle-view"),K(e=>e.Bool),w(()=>!1))),w(()=>!1))],qa=([r,t,n])=>e=>new s().kind("Div").attrs([{Class:"plugin"}]).kids([new s().kind("P").text(e),new s().kind("Label").text("Init"),new s().kind("Input").attrs([{OnClick:{Msg:["toggle-init",{Obj:[["plugin",V(e)],["checked",S(r)]]}]}},{Type:"checkbox"},{Checked:r}]),new s().kind("Label").text("Update"),new s().kind("Input").attrs([{OnClick:{Msg:["toggle-update",{Obj:[["plugin",V(e)],["checked",S(t)]]}]}},{Type:"checkbox"},{Checked:t}]),new s().kind("Label").text("View"),new s().kind("Input").attrs([{OnClick:{Msg:["toggle-view",{Obj:[["plugin",V(e)],["checked",S(n)]]}]}},{Type:"checkbox"},{Checked:n}])]).build();window.plugins.set("reggub",{init:te,update:ne,view:se});})();
